<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Transform image files using a registration or affine matrix — xformimage • nat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Transform image files using a registration or affine matrix — xformimage"><meta property="og:description" content="You should almost always call xform rather
  calling thanxformimage directly."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
    <li>
      <a href="../articles/neurons-as-graph.html">Working with individual neurons as graph structures</a>
    </li>
    <li>
      <a href="../articles/plotly.html">3D graphics</a>
    </li>
    <li>
      <a href="../articles/NeuroGeometry.html">NeuroGeometry: Analysing 3D morphology of neurons</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/Installation.html">Installation</a>
</li>
<li>
  <a href="../index.html#learn">Learn</a>
</li>
<li>
  <a href="../index.html#help">Help</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.github.io" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/nat" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transform image files using a registration or affine matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/nat/blob/HEAD/R/xformimage.R" class="external-link"><code>R/xformimage.R</code></a></small>
    <div class="hidden name"><code>xformimage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>You should almost always call <code><a href="xform.html">xform</a></code> rather
  calling than<code>xformimage</code> directly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">xformimage</span><span class="op">(</span><span class="va">reg</span>, <span class="va">image</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for character</span>
<span class="fu">xformimage</span><span class="op">(</span><span class="va">reg</span>, <span class="va">image</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for cmtkreg</span>
<span class="fu">xformimage</span><span class="op">(</span>
  <span class="va">reg</span>,
  <span class="va">image</span>,
  transformtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"warp"</span>, <span class="st">"affine"</span><span class="op">)</span>,
  direction <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for reglist</span>
<span class="fu">xformimage</span><span class="op">(</span><span class="va">reg</span>, <span class="va">image</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">xformimage</span><span class="op">(</span><span class="va">reg</span>, <span class="va">image</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>reg</dt>
<dd><p>A registration defined by a matrix or a <code>cmtkreg</code> object, or
a character vector specifying a path to a CMTK registration on disk (see
details). If <code>reg</code> is a character vector of length &gt;1 defining a
sequence of registration files on disk they should proceed from sample to
reference.</p></dd>
<dt>image</dt>
<dd><p>Nx3 matrix of image</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed to methods (and then eventually to
<code><a href="cmtk.reformatx.html">cmtk.reformatx</a></code>)</p></dd>
<dt>transformtype</dt>
<dd><p>Which transformation to use when the CMTK file contains
both warp (default) and affine (TODO)</p></dd>
<dt>direction</dt>
<dd><p>Whether to transform image from sample space to reference
space (called <strong>forward</strong> by CMTK) or from reference to sample space
(called <strong>inverse</strong> by CMTK). Default (when <code>NULL</code> is forward).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Character vector with path to transformed image.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>When passed a character vector, xformimage will check to see if it
  defines a path containing CMTK registration erroring out if this is not the
  case. If the path does indeed point to a CMTK registration, this method
  will hand off to xformimage.cmtkreg. A future TODO would be to provide a
  mechanism for extending this behaviour for other registration formats.
  If a list of transformations is passed in, these transformations are passed
  to the cmtk reformatx tool in the order received. Note that there is
  presently no support for</p><ul><li><p>using the inverse of a registration</p></li>
<li><p>specifying a mask</p></li>
<li><p>passing additional arguments to <code>reformatx</code></p></li>
</ul><p>Note that the direction of CMTK registrations can be the source of
  much confusion. This is because CMTK defines the <em>forward</em> direction
  as the transform required to reformat an image in <em>sample</em> (floating)
  space to an image in <em>template</em> space. Since this operation involves
  filling a regular grid in template space by looking up the corresponding
  positions in sample space, the transformation that is required is (somewhat
  counterintuitively) the one that maps template to sample. However in
  neuroanatomical work, one often has points in sample space that one would
  like to transform into template space. Here one needs CMTK's <em>inverse</em>
  transformation.</p>
<p>A second source of confusion is that when there are multiple
  transformations, CMTK's reformatx tool (wrapped by
  <code><a href="cmtk.reformatx.html">cmtk.reformatx</a></code>) expects them to be listed:</p>
<p><code>ref_intermediate.list intermediate_sample.list</code></p>
<p>where <code>ref_intermediate.list</code> is the CMTK registration obtained with
  ref as target/reference and intermediate as sample/floating image.</p>
<p>For consistency, all <code>xform.*</code> methods expect multiple registrations
  to be listed from sample to reference and this order is then swapped when
  they are passed on to <code>cmtk.reformatx</code>.</p>
<p>whereas CMTK's <code>streamxform</code> tool (wrapped by
  <code><a href="xformpoints.html">xformpoints</a></code>) expects them in the opposite order.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cmtk.reformatx.html">cmtk.reformatx</a></code>, <code><a href="xformpoints.html">xformpoints</a></code>,
  <code><a href="xform.html">xform</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis, James Manton, Sridhar Jagannathan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

