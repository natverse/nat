<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>neuron: class to represent traced neurons — neuron • nat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="neuron: class to represent traced neurons — neuron"><meta property="og:description" content='neuron makes a neuron object from appropriate variables.
is.neuron will check if an object looks like a neuron.
as.neuron will convert a suitable object to a neuron
as.neuron.data.frame expects a block of SWC format data
as.neuron.ngraph converts a graph (typically an 
  ngraph object) to a neuron
as.neuron.igraph will convert an ngraph compatible
  igraph object into a neuron.
as.neuron.default will add class "neuron" to a neuron-like
  object.'><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
    <li>
      <a href="../articles/neurons-as-graph.html">Working with individual neurons as graph structures</a>
    </li>
    <li>
      <a href="../articles/plotly.html">3D graphics</a>
    </li>
    <li>
      <a href="../articles/NeuroGeometry.html">NeuroGeometry: Analysing 3D morphology of neurons</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/Installation.html">Installation</a>
</li>
<li>
  <a href="../index.html#learn">Learn</a>
</li>
<li>
  <a href="../index.html#help">Help</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.github.io" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/nat" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>neuron: class to represent traced neurons</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/nat/blob/HEAD/R/neuron.R" class="external-link"><code>R/neuron.R</code></a></small>
    <div class="hidden name"><code>neuron.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>neuron</code> makes a neuron object from appropriate variables.</p>
<p><code>is.neuron</code> will check if an object looks like a neuron.</p>
<p><code>as.neuron</code> will convert a suitable object to a neuron</p>
<p><code>as.neuron.data.frame</code> expects a block of SWC format data</p>
<p><code>as.neuron.ngraph</code> converts a graph (typically an 
  <code>ngraph</code> object) to a neuron</p>
<p><code>as.neuron.igraph</code> will convert an <code>ngraph</code> compatible
  <code><a href="https://rdrr.io/pkg/igraph/man/aaa-igraph-package.html" class="external-link">igraph</a></code> object into a <code>neuron</code>.</p>
<p><code>as.neuron.default</code> will add class "neuron" to a neuron-like
  object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">neuron</span><span class="op">(</span>
  <span class="va">d</span>,
  NumPoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>,
  <span class="va">StartPoint</span>,
  BranchPoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">EndPoints</span>,
  <span class="va">SegList</span>,
  SubTrees <span class="op">=</span> <span class="cn">NULL</span>,
  InputFileName <span class="op">=</span> <span class="cn">NULL</span>,
  NeuronName <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  MD5 <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu">is.neuron</span><span class="op">(</span><span class="va">x</span>, Strict <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">as.neuron</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">as.neuron</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for ngraph</span>
<span class="fu">as.neuron</span><span class="op">(</span><span class="va">x</span>, vertexData <span class="op">=</span> <span class="cn">NULL</span>, origin <span class="op">=</span> <span class="cn">NULL</span>, Verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for igraph</span>
<span class="fu">as.neuron</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">as.neuron</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>d</dt>
<dd><p>matrix of vertices and associated data in SWC format</p></dd>
<dt>NumPoints</dt>
<dd><p>Number of points in master subtree</p></dd>
<dt>StartPoint, BranchPoints, EndPoints</dt>
<dd><p>Nodes of the neuron</p></dd>
<dt>SegList</dt>
<dd><p>List where each element contains the vertex indices for a 
single segments of the neuron, starting at root.</p></dd>
<dt>SubTrees</dt>
<dd><p>List of SegLists where a neuron has multiple unconnected 
trees (e.g. because the soma is not part of the graph, or because the 
neuronal arbour has been cut.)</p></dd>
<dt>InputFileName</dt>
<dd><p>Character vector with path to input file</p></dd>
<dt>NeuronName</dt>
<dd><p>Character vector containing name of neuron or a function 
with one argument (the full path) which returns the name. The default
(<code>NULL</code>) sets NeuronName to the file name without the file extension.</p></dd>
<dt>...</dt>
<dd><p>Additional fields to be included in neuron. Note that if these 
include CreatedAt, NodeName, InputFileStat or InputFileMD5, they will 
override fields of that name that are calculated automatically.</p></dd>
<dt>MD5</dt>
<dd><p>Logical indicating whether to calculate MD5 hash of input</p></dd>
<dt>x</dt>
<dd><p>A neuron or other object to test/convert</p></dd>
<dt>Strict</dt>
<dd><p>Whether to check class of neuron or use a more relaxed
definition based on object being a list with a SegList component.</p></dd>
<dt>vertexData</dt>
<dd><p>A dataframe with SWC fields especially X,Y,Z,W,PointNo,
Parent.</p></dd>
<dt>origin</dt>
<dd><p>Root vertex, matched against names (aka PointNo) when 
available (see details)</p></dd>
<dt>Verbose</dt>
<dd><p>Whether to be verbose (default: FALSE)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with elements: 
  (NumPoints,StartPoint,BranchPoints,EndPoints,nTrees,NumSegs,SegList, 
  [SubTrees]) NB SubTrees will only be present when nTrees&gt;1.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>neuron objects consist of a list containing multiple fields describing the 3D
location and connectivity of points in a traced neuron. The critical fields 
of a neuron, n, are n$d which contains a dataframe in SWC format and 
n$SegList which contains a representation of the neuron's topology used for 
most internal calculations. For historical reasons, n$SegList is limited to a
<em>single fully-connected</em> tree. If the tree contains multiple unconnected
subtrees, then these are stored in n$SubTrees and nTrees will be &gt;1; the 
"master" subtree (typically the one with the most points) will then be stored
in n$SegList and n$NumPoints will refer to the number of points in that 
subtree, not the whole neuron.</p>
<p>StartPoint, BranchPoints, EndPoints are indices matching the rows of 
  the vertices in <code>d</code> <strong>not</strong> arbitrary point numbers typically 
  encoded in <code>d$PointNo</code>.</p>
<p>Columns will be ordered c('PointNo','Label','X','Y','Z','W','Parent')</p>
<p>Uses a depth first search on the tree to reorder using the given 
  origin.</p>
<p>When the graph contains multiple subgraphs, only one will be chosen 
  as the master tree and used to construct the SegList of the resultant 
  neuron. However all subgraphs will be listed in the SubTrees element of the
  neuron and nTrees will be set appropriately.</p>
<p>When the graph vertices have a label attribute derived from PointNo,
  the origin is assumed to be specified with respect to the vertex labels 
  rather than the raw vertex ids.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="neuronlist.html">neuronlist</a></code></p>
<p><code>graph.dfs, <a href="seglist.html">as.seglist</a></code></p>
<p>Other neuron: 
<code><a href="ngraph.html">ngraph</a>()</code>,
<code><a href="plot.neuron.html">plot.dotprops</a>()</code>,
<code><a href="potential_synapses.html">potential_synapses</a>()</code>,
<code><a href="prune.html">prune</a>()</code>,
<code><a href="resample.html">resample</a>()</code>,
<code><a href="rootpoints.html">rootpoints</a>()</code>,
<code><a href="spine.html">spine</a>()</code>,
<code><a href="subset.neuron.html">subset.neuron</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## See help for functions listed in See Also for more detailed examples</span></span>
<span class="r-in"><span class="co">## Basic properties</span></span>
<span class="r-in"><span class="co"># a sample neuron </span></span>
<span class="r-in"><span class="va">n</span> <span class="op">=</span> <span class="va">Cell07PNs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># summarise it</span></span>
<span class="r-in"><span class="va">n</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'neuron' with 180 vertices in 1 tree</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># inspect its internal structure</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ CellType     : chr "DA1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ NeuronName   : chr "EBH11R"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ InputFileName: 'AsIs' chr "/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ CreatedAt    : POSIXt[1:1], format: "2006-01-17 15:21:14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ NodeName     : Named chr "jefferis.joh.cam.ac.uk"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "nodename"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ InputFileStat:'data.frame':	1 obs. of  10 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ size  : num 15379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ isdir : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mode  : 'octmode' int 644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mtime : POSIXt[1:1], format: "2006-01-12 00:52:01"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ctime : POSIXt[1:1], format: "2006-01-12 00:52:01"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ atime : POSIXt[1:1], format: "2006-01-17 15:21:14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ uid   : int 501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ gid   : int 501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ uname : chr "jefferis"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ grname: chr "jefferis"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ InputFileMD5 : Named chr "fcacee3f874cbe2c6ad96214e6fee337"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= 'AsIs' chr "/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ NumPoints    : int 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ StartPoint   : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BranchPoints : num [1:16] 34 48 51 75 78 95 98 99 108 109 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ EndPoints    : num [1:18] 1 42 59 62 80 85 96 100 102 112 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ NumSegs      : int 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SegList      :List of 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:34] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:9] 34 35 36 37 38 39 40 41 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:7] 34 43 44 45 46 47 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:4] 48 49 50 51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:9] 51 52 53 54 55 56 57 58 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:4] 51 60 61 62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:14] 48 63 64 65 66 67 68 69 70 71 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:4] 75 76 77 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:3] 78 79 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:6] 78 81 82 83 84 85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:11] 75 86 87 88 89 90 91 92 93 94 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:2] 95 96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:3] 95 97 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:2] 98 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:2] 99 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:3] 99 101 102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:7] 98 103 104 105 106 107 108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:2] 108 109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:4] 109 110 111 112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:4] 109 113 114 115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:3] 115 116 117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:3] 115 118 119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:3] 119 120 121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:14] 119 122 123 124 125 126 127 128 129 130 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:2] 108 135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:9] 135 136 137 138 139 140 141 142 143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:6] 143 144 145 146 147 148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:7] 143 149 150 151 152 153 154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:7] 135 155 156 157 158 159 160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:6] 160 161 162 163 164 165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:5] 160 166 167 168 169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:4] 169 170 171 172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:9] 169 173 174 175 176 177 178 179 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ d            :'data.frame':	180 obs. of  7 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ PointNo: int [1:180] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Label  : num [1:180] 2 2 2 2 2 2 2 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ X      : num [1:180] 187 187 188 188 188 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Y      : num [1:180] 133 131 130 129 129 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Z      : num [1:180] 88.2 90.6 93.1 95 97.5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ W      : num [1:180] 1.01 1.27 1.14 1.27 1.27 1.27 1.27 1.27 1.27 1.27 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Parent : num [1:180] -1 1 2 3 4 5 6 7 8 9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ OrientInfo   :List of 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ AxonOriented: logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ AVMPoint    : logi NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ AVLPoint    : logi NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Scl         : num [1:3] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ NewAxes     : num [1:3] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SegOrders    : num [1:33] 1 2 2 3 4 4 3 4 5 5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ MBPoints     : int [1:2] 34 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ LHBranchPoint: int 75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SegTypes     : num [1:33] 1 3 1 3 3 3 1 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ AxonSegNos   :List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ PreMBAxons : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ MBAxons    : int 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ PostMBAxons: int 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ LHSegNos     : num [1:26] 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ MBSegNos     :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:3] 4 5 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ NumMBBranches: num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ AxonLHEP     : num 72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "neuron" "list"</span>
<span class="r-in"><span class="co"># summary of 3D points</span></span>
<span class="r-in"><span class="fu"><a href="summary.neuron.html">summary</a></span><span class="op">(</span><span class="fu"><a href="xyzmatrix.html">xyzmatrix</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X               Y                Z        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :186.9   Min.   : 90.36   Min.   : 88.2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:225.6   1st Qu.: 97.56   1st Qu.:103.4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :258.4   Median :102.70   Median :112.9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   :249.4   Mean   :104.03   Mean   :120.9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:277.7   3rd Qu.:109.04   3rd Qu.:139.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :289.5   Max.   :132.71   Max.   :157.3  </span>
<span class="r-in"><span class="co"># identify 3d location of endpoints</span></span>
<span class="r-in"><span class="fu"><a href="xyzmatrix.html">xyzmatrix</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="rootpoints.html">endpoints</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            X         Y         Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   186.8660 132.70932  88.20393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  224.7067 109.86362 153.58749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  229.6343  92.30637 157.29700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  226.8855  90.36325 147.59602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  249.8864  93.59079 136.77795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  253.0099  90.94904 137.34921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  264.0801  98.53390 121.89463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 266.3223  98.73241 116.46558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 267.5460  98.59859 112.85608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 271.0762 102.67288 100.84955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 274.6128 100.92061 103.28772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 277.3920 102.19148 102.69473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134 287.1214 101.43365 103.30740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148 281.7958  96.63987 101.08075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154 276.6551  95.09809  99.22113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165 278.3287 113.75627 104.87700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172 282.3069 111.93213 105.65492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180 289.5364 111.96014 109.18281</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Other methods</span></span>
<span class="r-in"><span class="co"># plot</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># all methods for neuron objects</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">'neuron'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] Ops                all.equal          as.neuron          as.ngraph         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] as.seglist         branchpoints       dotprops           endpoints         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] intersect_plane    ndigest            nvertices          plot              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] plot3d             potential_synapses print              prune             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] prune_in_volume    prune_online       prune_twigs        reroot            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] resample           rootpoints         scale              sholl_analysis    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] subset             summary            write.vtk          xform             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] xyzmatrix          xyzmatrix&lt;-       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> see '?methods' for accessing help and source code</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Neurons as graphs </span></span>
<span class="r-in"><span class="co"># convert to graph and find longest paths by number of nodes</span></span>
<span class="r-in"><span class="va">ng</span><span class="op">=</span><span class="fu"><a href="ngraph.html">as.ngraph</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html" class="external-link">distances</a></span><span class="op">(</span><span class="va">ng</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># ... or in distances  microns</span></span>
<span class="r-in"><span class="va">ngw</span><span class="op">=</span><span class="fu"><a href="ngraph.html">as.ngraph</a></span><span class="op">(</span><span class="va">n</span>, weights<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html" class="external-link">distances</a></span><span class="op">(</span><span class="va">ngw</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># converting back and forth between neurons and graphs</span></span>
<span class="r-in"><span class="va">g</span><span class="op">=</span><span class="fu"><a href="ngraph.html">as.ngraph</a></span><span class="op">(</span><span class="va">Cell07PNs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gstem</span><span class="op">=</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html" class="external-link">induced.subgraph</a></span><span class="op">(</span><span class="va">g</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># this is fine</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gstem</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">as.neuron</span><span class="op">(</span><span class="va">gstem</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># but if you had an undirected graph </span></span>
<span class="r-in"><span class="va">ug</span><span class="op">=</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span><span class="va">gstem</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># you get a warning because there is no explicit origin for the graph</span></span>
<span class="r-in"><span class="fu">as.neuron</span><span class="op">(</span><span class="va">ug</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No valid origin found! Using first endpoint as origin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'neuron' with 10 vertices in 1 tree</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># If you need finer control of the conversion process </span></span>
<span class="r-in"><span class="va">gstem2</span><span class="op">=</span><span class="fu"><a href="ngraph.html">as.ngraph</a></span><span class="op">(</span><span class="va">ug</span>, root <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gstem2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">as.neuron</span><span class="op">(</span><span class="va">gstem2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="neuron-7.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis, James Manton, Sridhar Jagannathan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

