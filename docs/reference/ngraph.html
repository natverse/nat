<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ngraph: a graph to encode a neuron's connectivity — ngraph • nat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="ngraph: a graph to encode a neuron's connectivity — ngraph"><meta property="og:description" content="the ngraph class contains a (completely general) graph
  representation of a neuron's connectivity in an igraph object. It
  may additionally contain vertex name or position data. See Connectivity
  section.
ngraph() creates an ngraph from edge and vertex information.
as.ngraph converts an object to an ngraph
as.ngraph.dataframe construct ngraph from a data.frame 
  containing SWC format data
as.ngraph.neuron construct ngraph from a neuron"><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
    <li>
      <a href="../articles/neurons-as-graph.html">Working with individual neurons as graph structures</a>
    </li>
    <li>
      <a href="../articles/plotly.html">3D graphics</a>
    </li>
    <li>
      <a href="../articles/NeuroGeometry.html">NeuroGeometry: Analysing 3D morphology of neurons</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/Installation.html">Installation</a>
</li>
<li>
  <a href="../index.html#learn">Learn</a>
</li>
<li>
  <a href="../index.html#help">Help</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://natverse.github.io" class="external-link">natverse</a>
</li>
<li>
  <a href="https://github.com/natverse/nat" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ngraph: a graph to encode a neuron's connectivity</h1>
    <small class="dont-index">Source: <a href="https://github.com/natverse/nat/blob/HEAD/R/ngraph.R" class="external-link"><code>R/ngraph.R</code></a></small>
    <div class="hidden name"><code>ngraph.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>the <code>ngraph</code> class contains a (completely general) graph
  representation of a neuron's connectivity in an <code>igraph</code> object. It
  may additionally contain vertex name or position data. See Connectivity
  section.</p>
<p><code>ngraph()</code> creates an ngraph from edge and vertex information.</p>
<p><code>as.ngraph</code> converts an object to an ngraph</p>
<p><code>as.ngraph.dataframe</code> construct ngraph from a data.frame 
  containing SWC format data</p>
<p><code>as.ngraph.neuron</code> construct ngraph from a neuron</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ngraph</span><span class="op">(</span>
  <span class="va">el</span>,
  <span class="va">vertexnames</span>,
  xyz <span class="op">=</span> <span class="cn">NULL</span>,
  diam <span class="op">=</span> <span class="cn">NULL</span>,
  directed <span class="op">=</span> <span class="cn">TRUE</span>,
  weights <span class="op">=</span> <span class="cn">FALSE</span>,
  vertex.attributes <span class="op">=</span> <span class="cn">NULL</span>,
  graph.attributes <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="fu">as.ngraph</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">as.ngraph</span><span class="op">(</span><span class="va">x</span>, directed <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for neuron</span>
<span class="fu">as.ngraph</span><span class="op">(</span><span class="va">x</span>, directed <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"swc"</span>, <span class="st">"seglist"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>el</dt>
<dd><p>A two column matrix (start, end) defining edges. <code>start</code> means
closer to the root (soma) of the neuron.</p></dd>
<dt>vertexnames</dt>
<dd><p>Integer names for graph nodes - the edge list is specified
using these names (see details).</p></dd>
<dt>xyz</dt>
<dd><p>3D coordinates of vertices (optional, Nx3 matrix, or Nx4 matrix
when 4th column is assumed to be diameter)</p></dd>
<dt>diam</dt>
<dd><p>Diameter of neuron at each vertex (optional)</p></dd>
<dt>directed</dt>
<dd><p>Whether the resultant graph should be directed (default TRUE)</p></dd>
<dt>weights</dt>
<dd><p>Logical value indicating whether edge weights defined by the
3D distance between points should be added to graph (default <code>FALSE</code>)
<em>or</em> a numeric vector of weights.</p></dd>
<dt>vertex.attributes, graph.attributes</dt>
<dd><p>List of named attributes to be
added to the graph. The elements of <code>vertex.attributes</code> must be
vectors whose length is compatible with the number of elements in the
graph. See <code><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html" class="external-link">set.vertex.attribute</a></code> for details.</p></dd>
<dt>x</dt>
<dd><p>Object to convert (see method descriptions)</p></dd>
<dt>...</dt>
<dd><p>Arguments passed to methods</p></dd>
<dt>method</dt>
<dd><p>Whether to use the swc data (x$d) or the seglist to define 
neuronal connectivity to generate graph.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an <code>igraph</code> object with additional class <code>ngraph</code>, having a
  vertex for each entry in vertexnames, each vertex having a <code>label</code>  attribute. All vertices are included whether connected or not.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that the <code>as.ngraph.neuron</code> method <em>always</em> keeps the
  original vertex names (a.k.a. PointNo) as read in from the original file.</p>
    </div>
    <div id="connectivity">
    <h2>Connectivity</h2>
    <p>We make the following assumptions about neurons coming
  in</p>
<p></p><ul><li><p>They have an integer vertex name that need not start from 1 and that
  may have gaps. This is analogous to the PointNo field of the core data
  block of <code><a href="neuron.html">neuron</a></code> objects.</p></li>
<li><p>The edge list that defines connectivity specifies those edges using
  pairs of vertex names, _not_ raw vertex indices.</p></li>
</ul><p>We make no attempt to determine the root points at this stage.</p>
<p>The raw vertex ids in the graph will be in the order of vertexnames and can
  therefore be used to index a block of vertex coordinates. The vertexnames
  will be stored using the vertex attribute <code>name</code>. The underlying
  igraph class allows nodes to be specified by their name. This provides a
  convenient way to define nodes in an ngraph object by the numeric
  identifier encoded by the PointNo field of the corresponding
  <code><a href="neuron.html">neuron</a></code>.</p>
<p>When the graph is directed (default) the edges will be from the root to the
  other tips of the neuron.</p>
    </div>
    <div id="morphology">
    <h2>Morphology</h2>
    <p>The morphology of the neuron is encoded by the
  combination of connectivity information (i.e. the graph) and spatial data
  encoded as the 3D position and diameter of each vertex. Position
  information is stored as vertex attributes X, Y, and Z.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/igraph/man/aaa-igraph-package.html" class="external-link">igraph</a></code>, <code><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html" class="external-link">set.vertex.attribute</a></code>,
  <code><a href="subset.neuron.html">subset.neuron</a></code> for example of graph-based manipulation of a
  neuron, <code><a href="plot3d.ngraph.html">plot3d.ngraph</a></code></p>
<p>Other neuron: 
<code><a href="neuron.html">neuron</a>()</code>,
<code><a href="plot.neuron.html">plot.dotprops</a>()</code>,
<code><a href="potential_synapses.html">potential_synapses</a>()</code>,
<code><a href="prune.html">prune</a>()</code>,
<code><a href="resample.html">resample</a>()</code>,
<code><a href="rootpoints.html">rootpoints</a>()</code>,
<code><a href="spine.html">spine</a>()</code>,
<code><a href="subset.neuron.html">subset.neuron</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">n</span><span class="op">=</span><span class="va">Cell07PNs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="va">g</span><span class="op">=</span><span class="fu">as.ngraph</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org" class="external-link">igraph</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘igraph’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:nat’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:testthat’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     compare</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     decompose, spectrum</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     union</span>
<span class="r-in"><span class="co"># check that vertex attributes of graph match X position</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">X</span>, <span class="va">n</span><span class="op">$</span><span class="va">d</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use 3D segment lengths as edge length of graph</span></span>
<span class="r-in"><span class="va">gw</span><span class="op">=</span><span class="fu">as.ngraph</span><span class="op">(</span><span class="va">n</span>, weights<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># find longest path across graph</span></span>
<span class="r-in"><span class="va">d</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/diameter.html" class="external-link">get.diameter</a></span><span class="op">(</span><span class="va">gw</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># make a new neuron using the longest path</span></span>
<span class="r-in"><span class="va">gw_spine</span><span class="op">=</span><span class="fu"><a href="neuron.html">as.neuron</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html" class="external-link">induced.subgraph</a></span><span class="op">(</span><span class="va">gw</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># make a new neuron containing all nodes except those in longest path</span></span>
<span class="r-in"><span class="va">gw_antispine</span><span class="op">=</span><span class="fu"><a href="neuron.html">as.neuron</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/delete_vertices.html" class="external-link">delete.vertices</a></span><span class="op">(</span><span class="va">gw</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># note use of bounding box of original neuron to set plot axes</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gw_spine</span>, col<span class="op">=</span><span class="st">'red'</span>, boundingbox<span class="op">=</span><span class="fu"><a href="boundingbox.html">boundingbox</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gw_antispine</span>, col<span class="op">=</span><span class="st">'blue'</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ngraph-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gregory Jefferis, James Manton, Sridhar Jagannathan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

